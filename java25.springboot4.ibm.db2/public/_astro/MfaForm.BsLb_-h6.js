import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as o}from"./index.-FKaPJU3.js";import{a as S}from"./index.ngrFHoWO.js";import{$ as j}from"./jquery.CUqvW-kL.js";import"./_commonjsHelpers.CqkleIqs.js";const v=S.create({baseURL:"http://localhost:9090",headers:{Accept:"application/json","Content-Type":"application/json"}});function M(){const[i,n]=o.useState(""),[c,t]=o.useState(""),[m,p]=o.useState(""),[u,b]=o.useState(""),[r,f]=o.useState(!1),g=a=>{a.preventDefault();const d=sessionStorage.getItem("USERID");d&&p(d);const l=sessionStorage.getItem("TOKEN");l&&b(l);const x=JSON.stringify({otp:i});v.patch(`api/mfa/verifytotp/${m}`,x,{headers:{Authorization:`Bearer ${u}`}}).then(s=>{t(s.data.message),sessionStorage.setItem("USERNAME",s.data.username),setTimeout(()=>{j("#staticMfa").hide(),t(""),window.location.reload()},3e3)},s=>{s.response?t(s.response.data.message):t(s.message),setTimeout(()=>{t(""),f(!1)},3e3)})},h=a=>{a.preventDefault(),n(""),t(""),window.sessionStorage.removeItem("USERID"),window.sessionStorage.removeItem("USERNAME"),window.sessionStorage.removeItem("USERPIC"),window.sessionStorage.removeItem("TOKEN"),location.href="/",location.reload()};return e.jsx("div",{className:"modal fade",id:"staticMfa","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:-1,"aria-labelledby":"staticMfaLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-sm modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-warning",children:[e.jsx("h5",{className:"modal-title text-primay fs-5",id:"staticMfaLabel",children:"Multi-Factor Authentictor"}),e.jsx("button",{onClick:h,type:"button",className:"btn-close btn-close-primary","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:g,autoComplete:"off",children:[e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"text",required:!0,value:i,onChange:a=>n(a.target.value),disabled:r,className:"form-control border-warning",id:"otp",placeholder:"enter 6-digit OTP code"})}),e.jsx("button",{type:"submit",disabled:r,className:"btn btn-warning",children:"submit"})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("div",{className:"w-100 text-center text-danger",children:c})})]})})})}export{M as default};
