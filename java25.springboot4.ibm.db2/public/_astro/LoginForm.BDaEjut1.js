import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{R as i}from"./index.-FKaPJU3.js";import{$ as n}from"./jquery.CUqvW-kL.js";import{a as h}from"./index.ngrFHoWO.js";import"./_commonjsHelpers.CqkleIqs.js";const f=h.create({baseURL:"http://localhost:9090",headers:{Accept:"application/json","Content-Type":"application/json"}});function v(){const[r,d]=i.useState(""),[m,c]=i.useState(""),[u,t]=i.useState(""),[l,o]=i.useState(!1);function p(s){s.preventDefault(),o(!0),t("Please wait...");const g=JSON.stringify({username:r,password:m});f.post("auth/signin",g).then(a=>{t(a.data.message),a.data.qrcodeurl!==null?(sessionStorage.setItem("USERID",a.data.id),sessionStorage.setItem("TOKEN",a.data.token),sessionStorage.setItem("USERPIC",`http://localhost:9090/users/${a.data.userpic}`),o(!1),setTimeout(()=>{n("#loginReset").trigger("click"),n("#mfaModal").trigger("click")},3e3)):(sessionStorage.setItem("USERID",a.data.id),sessionStorage.setItem("USERNAME",a.data.username),sessionStorage.setItem("TOKEN",a.data.token),sessionStorage.setItem("USERPIC",`http://localhost:9090/users/${a.data.userpic}`),o(!1),setTimeout(()=>{location.href="/",n("#closeLogin").trigger("click"),window.location.reload()},3e3))},a=>{a.response?t(a.response.data.message):t(a.message),setTimeout(()=>{t(""),o(!1)},3e3)})}const b=s=>{s.preventDefault(),d(""),c(""),t(""),o(!1)};return e.jsx("div",{className:"modal fade",id:"staticLogin","data-bs-backdrop":"static","data-bs-keyboard":"false",tabIndex:-1,"aria-labelledby":"staticLoginLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog modal-sm modal-dialog-centered",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header bg-primary",children:[e.jsx("h1",{className:"modal-title text-white fs-5",id:"staticLoginLabel",children:"User's Login"}),e.jsx("button",{id:"closeLogin",type:"button",className:"btn-close btn-close-white","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:e.jsxs("form",{onSubmit:p,method:"post",autoComplete:"off",children:[e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"text",required:!0,value:r,onChange:s=>d(s.target.value),className:"form-control border-primary",id:"usrname",name:"usrname",disabled:l,placeholder:"enter username"})}),e.jsx("div",{className:"mb-3",children:e.jsx("input",{type:"password",required:!0,value:m,onChange:s=>c(s.target.value),className:"form-control border-primary",id:"passwd",name:"passwd",disabled:l,placeholder:"enter password"})}),e.jsx("button",{type:"submit",className:"btn btn-primary mx-1",disabled:l,children:"login"}),e.jsx("button",{id:"reset",type:"reset",onClick:b,className:"btn btn-primary mx-1",children:"reset"}),e.jsx("button",{type:"button",id:"mfaModal",className:"btn btn-primary","data-bs-toggle":"modal","data-bs-target":"#staticMfa",children:"mfa"})]})}),e.jsx("div",{className:"modal-footer",children:e.jsx("div",{className:"w-100 text-center text-danger",children:u})})]})})})}export{v as default};
